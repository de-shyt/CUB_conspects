

# Algorithms and Data Structures 

*Author: Daria Shutina*



[TOC]



### 22-09-07 :  Dynamic programming 

### –ê–ª–≥–æ—Ä–∏—Ç–º –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞

–ö–∞–∫ –∏–∑ —Å—Ç—Ä–æ–∫–∏ `STUDENT` –ø–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä–æ–∫—É `POSUDA`

<img src="./pics for conspects/ALG/ALG 22-09-07 1.png" alt="ALG 22-09-07 1" style="zoom:50%;" />



From a word S we want to get a word T. Possible operations:

-  insert a letter
- remove a letter
- replace a letter 



`d[i][j]`  ==  min amount of operations to change `S[1..i]` into `T[1..j]`



**Base:**

`d[0][j] = j` (just insert letters into S and get T)

`d[i][0] = i`



**Transition:**
$$
d[i][j] = min
\begin{equation*}
 \begin{cases}
   d[i - 1][j] + 1   \texttt{\small (insert a char.)}\\
   d[i][j - 1] + 1   \texttt{\small (remove a char.)}\\
   d[i - 1][j - 1] + 1   \texttt{\small (replace a char.)}\\
 \end{cases}
\end{equation*} \\
$$






#### Approaches to compute dynamically 

1) Recursion + Memorization *aka* Lazy DP 

   ```c++
   int f(i, j) {
       if (dp[i][j] is computed) // <------- that is where memorization is used 
           return dp[i][j];
       return f(i - 1, j) + 1;
       ...
   }
   ```

   

2)  Using a for-cycle

   ```c++
   for i = 1..n {
       for j = 1..m // provided that dp[1..i-1][1..j-1] is computed correctly
       {
           dp[i][j] = min(dp[i][j], dp[i - 1][j] + 1);
           dp[i][j] = min(dp[i][j], dp[i][j - 1] + 1);
           ...
       }
   }
   ```







#### DP on (sub)sets :  TSP

TSP -- travelling Salesman Problem -- find a path visiting all vertexes only once. 

Weight of the path should be minimal. 



`d[S, v]` -- min weight of a path which ends in `v` and visits vertices that are in subset `S` once. 

Answer is in `d[{1,...,n}, v]`



**Base:**

- \forall v :       S = {v}        d[S, v] = 0        d[S, u] = +inf for u \neq v
- d[S, v] = +inf for v \notin S



**Transition:**
$$
d[S, v] = \underset{u \in S}{min} \ \{ \ d[S/\{v\}, u] + w_{uv} \ \}
$$


**Time:** $O(2^n n^2)$

**Memory:** $O(2^n n)$



```c++
// Base cases 
for (v = 0..n-1) {
    S = 1 << v;            // S = {v}
    for (u = 0..n-1) {
        if (v == u)
            d[S][u] = 0;
        else 
            d[S][u] = +inf;
    }
}

// –ø–µ—Ä–µ—Ö–æ–¥ 
for ( S = 0 .. (1<<n)-1 ) {
    for (v = 0..n-1) 
    {
        if (S >> v mod 2 == 0) {     // check if v \notin S
            d[S][v] = +inf;
            continue;
        }
        for (uv \in E) {      // looking at edges between v and other vertices
            d[S][v] = min(d[S][v], d[S - (1 << v)][u] + weight[u][v])   //  S\{v}
        }
    }
}
```







#### Coloring a graph 

The goal is to minimize amount of different colors. The graph is *undirected*.

V = {0,...,n-1} -- all vertices.   S \in V



`d[S]` == min # of colors used to color subgraph on vertices from S

Answer is in `d[V]`



**Base:**

- `d[\varnothing] = 0`
- `d[i] = 1 \forall i = 0..n-1`



**Transition:** 
$$
d[S] = \underset{T \subset S}{\min} \ \{ \ d[T] + 1 \ \} \ \ \textnormal{ \small (T is an independent set. '+1' for coloing it)}
$$


```
for (S = 0..2^n-1) {
    for (t = S..1)
}
```









### –ì–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ –ø—É—Ç—å 

–ì–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ –ø—É—Ç—å ‚Äì –ø—É—Ç—å, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π –ø–æ –≤—Å–µ–º –≤–µ—Ä—à–∏–Ω–∞–º —Ä–æ–≤–Ω–æ –ø–æ –æ–¥–Ω–æ–º—É —Ä–∞–∑—É

`dp[A][v]` ‚Äì –º–æ–∂–Ω–æ –ª–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Ç—å, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π —á–µ—Ä–µ–∑ –≤–µ—Ä—à–∏–Ω—ã –º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A$ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–π—Å—è –≤ –≤–µ—Ä—à–∏–Ω–µ $v$.



#### $O(2^n n^2)$

```c++
for v = [0..n-1] :
    dp[1 << v][v] = 1 // –ø—É—Ç—å –∏–∑ –≤–µ—Ä—à–∏–Ω—ã v –≤ –≤–µ—Ä—à–∏–Ω—É v —Ä–∞–≤–µ–Ω 1

for A = [1..(1<<n)-1] :
    for v = [0..n] :
        if (dp[A][v]) :
            for x = [0..n-1] :
                if ((A&(1<<x)) == 0) && C[x][v] :
                    dp[A|(1<<x)][x] = 1;
```



#### $O(2^n n)$

`g[x]` -- —Å–æ—Å–µ–¥–∏ –≤–µ—Ä—à–∏–Ω–∫–∏ $x$. 

`ends[A]` -- –≤–µ—Ä—à–∏–Ω–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–µ—Ç –∑–∞–∫–æ–Ω—á–∏—Ç—å—Å—è –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ –ø—É—Ç—å, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π —á–µ—Ä–µ–∑ –≤—Å–µ –≤–µ—Ä—à–∏–Ω–∫–∏ –∏–∑ $A$. 

```c++
for (x = 0 .. n):
	ends[1 << x] = (1 << x)
for (A = 1 .. (1 << n)):
	for (x = 0 .. n):
		if (A & (1 << x) == 0 && g[x] & ends[A]):
			ends[A | (1 << x)] |= (1 << x)
```





### –ì–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª 

–ò–∑–ø–æ–ª—å–∑—É–µ–º `ends` –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ –ø—É—Ç—å. –¶–∏–∫–ª –µ—Å—Ç—å, –µ—Å–ª–∏ `ends[0] & ends[(1 << n) - 1] != 0`.







### –ü–µ—Ä–µ–±–æ—Ä –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ 

–ó–∞ $O(3^n)$  ( $B \subset A \ \Rightarrow$  $r$-—ã–µ –±–∏—Ç–∏–∫–∏ –≤ $(B, A)$ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–≤–Ω—ã $(0, 1), \ (1, 1)$  –∏–ª–∏ $(0, 0)$ )

```c++
for (A = 1; A < (1 << n); ++A)
    for (B = A; B >= 0; B = (B-1) & A) {
        ....
    }
```







### –ü–µ—Ä–µ–±–æ—Ä –Ω–∞–¥–º–Ω–æ–∂–µ—Å—Ç–≤

$A$ -- –Ω–∞–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ $B$, –µ—Å–ª–∏ $B \subset A$ –∏ $A/B$ -- –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ. 

–°–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–ø–æ–¥—Å—á–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–Ω–æ–∂–µ—Å—Ç–≤ –∑–∞ $O(2^n n)$, –ø–æ—Ç–æ–º –ø–µ—Ä–µ–±–æ—Ä –∑–∞ $O(3^n)$.

```c++
dp[0] = 0;

for (a = 1 .. (1 << n)):
    up = A & ~(A - 1)  // –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∏—Ç–∏–∫ 
        if (A & (1 << up)):
	        is[A] = is[A ^ (1 << up)] & (g[up] && A == 0)
        
for (A = 1 .. (1 << n)):
    for (B = A; B < (1 << n); B = (B+1) | A):
        if (A & B == B && is[A ^ B]):
            ....
```







### –í–µ—Ä—à–∏–Ω–Ω–∞—è –ø–æ–∫—Ä–∞—Å–∫–∞ 

–ü–æ–∫—Ä–∞—Å–∏—Ç—å –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞ –≤ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ —Ü–≤–µ—Ç–æ–≤



#### $O(4^n)$

–°–Ω–∞—á–∞–ª–∞ –ø–æ—Å—á–∏—Ç–∞–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–Ω–æ –Ω–µ–∑–∞—Å–∏–≤–∏–º—ã–º. –ú–æ–∂–Ω–æ –≤—Ç—É–ø—É—é –∑–∞ $O(2^n n^2)$, –º–æ–∂–Ω–æ –∑–∞ $O(2^n)$ (—Å–º. –≤ [–ü–µ—Ä–µ–±–æ—Ä–µ –Ω–∞–¥–º–Ω–æ–∂–µ—Å—Ç–≤](###–ø–µ—Ä–µ–±–æ—Ä –Ω–∞–¥–º–Ω–æ–∂–µ—Å—Ç–≤)). 

–¢–µ–ø–µ—Ä—å –¥–ø—à–µ—á–∫–∞. –°–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ $B$, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–µ–∂–∏—Ç –≤ –¥—Ä—É–≥–æ–º –ø–æ–¥—Å–º–Ω–æ–∂–µ—Å—Ç–≤–µ $A$. –ï—Å–ª–∏ $B$ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ, —Ç–æ —Ä–µ–ª–∞–∫—Å–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è $A$ –∏ $A/B$. 

```c++
for (A = 1.. (1 << n)):
    for (B = 1 .. (1 << n):
        if (A & B == B && is[B]):
            dp[A] = min(dp[A], dp[A & ~B] + 1)
```



#### $O(3^n)$

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ –º—ã –ø–µ—Ä–µ–±–∏—Ä–∞–ª–∏ –Ω–∞–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞. –ü–µ—Ä–µ–ø–∏—à–µ–º –∫–æ–¥

```c++
// –ø—Ä

for (B = 1.. (1 << n)):
    if (is[B]):
		for (A = B; A < (1 << n); A = (A + 1) | B):
        	dp[A] = min(dp[A], dp[A ^ B] + 1)
```











## 22-09-21

### –¢—Ä—é–∫–∏ —Å –º–∞—Å–∫–∞–º–∏

#### reverse

16-–±–∏—Ç–Ω—ã–µ —á–∏—Å–ª–∞.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —á–∏—Å–ª–æ $n$. 

- –æ—Ç–∫—É—Å–∏–º —É –Ω–µ–≥–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∏—Ç ( `n >> 1` ). –í –Ω–∞—á–∞–ª–µ —á–∏—Å–ª–∞ –ø–æ—è–≤–∏–ª—Å—è –≤–µ–¥—É—â–∏–π –Ω–æ–ª—å, —Ç–∞–∫ –∫–∞–∫ –∫–æ–ª-–≤–æ –±–∏—Ç–æ–≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ
- –ø–æ–ª—É—á–µ–Ω–Ω—É—é —à—Ç—É–∫—É –ø–µ—Ä–µ–≤–µ—Ä–Ω–µ–º ( `rev[n >> 1]` )
- —É–±–µ—Ä–µ–º –≤–µ–¥—É—â–∏–π –Ω–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–ø–µ—Ä—å –æ–∫–∞–∑–∞–ª—Å—è –≤ –∫–æ–Ω—Ü–µ —á–∏—Å–ª–∞ ( `rev[n >> 1] >> 1 `)
- –≤ –Ω–∞—á–∞–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–æ–±–∞–≤–∏–º —á–∏—Å–µ–ª–∫–æ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –æ—Ç–∫—É—Å–∏–ª–∏ –≤ –ø–µ—Ä–≤–æ–º –ø—É–Ω–∫—Ç–µ  ( `| ((n & 1) << 15)` )

```c++
for n = 1..(1 << 16) - 1 :
    rev[n] = (rev[n >> 1] >> 1) | ((n & 1) << 15);
```





#### –ú–ª–∞–¥—à–∏–π –±–∏—Ç

```c++
n & -(n - 1)
```





#### –°—Ç–∞—Ä—à–∏–π –±–∏—Ç

–ü—Ä–µ–¥–ø–æ–¥—Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ä—à–∏–π –±–∏—Ç –¥–ª—è —á–∏—Å–µ–ª –æ—Ç 0 –¥–æ (1 << 16)-1

```c++
msb = 0;
for (int m = 1; m < (1 << n); ++m) {
    if (m == (1 << (msb + 1)))  // —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —Å—Ç–∞—Ä—à–∏–π –±–∏—Ç —É—Å—Ç–∞—Ä–µ–ª 
        ++msb;                  // (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫ —á–∏—Å–ª—É 11..1 –ø—Ä–∏–±–∞–≤–∏–ª–∏ 1)
    ....
}
```





#### bitset

`bitset<N> b` 

- —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã

- –∑–∞–Ω–∏–º–∞–µ—Ç $\frac{N}{w}$ –±–∞–π—Ç, –≥–¥–µ $w = 8$ -- –º–∞—à–∏–Ω–Ω–æ–µ —Å–ª–æ–≤–æ

  <img src="./pics for conspects/ALG/ALG 22-09-21 2.png" alt="ALG 22-09-21 2" style="zoom:50%;" />





### Meet in the middle

#### –ü—Ä–∏–º–µ—Ä –Ω–∞ —Ä—é–∫–∑–∞–∫–µ 

–†–µ—à–µ–Ω–∏–µ –∑–∞ $O(2^{\frac{n}{2}}n)$

<img src="./pics for conspects/ALG/ALG 22-09-21 1.jpg" alt="ALG 22-09-21 1" style="zoom:50%;" />



1. $O(2^{n/2})$ :       –í—ã–ø–∏—Å—ã–≤–∞–µ–º –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –∏–∑ $A$.  $a \in A$. 

2. $O(2^{n/2} \frac{n}{2})$ :   –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞—Ä—ã { $weight_a, cost_a$ } –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –≤–µ—Å–æ–≤ 

3. $O(2^{n/2})$ :       –ü–æ—Å—á–∏—Ç–∞–µ–º –º–∞–∫—Å–∏–º—É–º—ã $cost_a$ –Ω–∞ –ø—Ä–µ—Ñ–∏–∫—Å–∞—Ö: `maxC[i+1] = std::max(maxC[i], cost[i+1])`
4. –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –∏–∑ $B$







### BST 

```c++
struct Node {
    Node* left;
    Node* right;
    Node* parent;
    int x;
    auto it;       // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–µ—Å—Ç–æ –≤ —Å–ø–∏—Å–∫–µ
}

using pNode = Node*;
```





#### find, next

```c++
bool find(Node* v, int x) {    // O(n)
    if (v == nullptr) 
        return nullptr;
    if (!v->left && !v->right)
        return false;
    if (v->x == x)
        return true;
    if (v->x < x)
        find(c->right, x);
    find(v->left, x);
}

Node* next(Node* v) {    // O(n)
    if (v->right) {
        v = v->right;
        while (v->left)     
            v = v->left;   
    }
    return v;
}
```





#### add

–î–æ—Ö–æ–¥–∏–º –¥–æ –º–æ–º–µ–Ω—Ç–∞ –∫–æ–≥–¥–∞ —É –≤–µ—Ä—à–∏–Ω–∫–∏ –Ω–µ—Ç –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞

```c++
Node* add(Node* v, int x) {    // O(n)

    if (!v->left && !v->right)
        return new Node(x);
    else if (x < v->x)
        v->left = add(v->left, x);
    else if (x > v->x)
        v->right = add(v->right, x);
}
```





#### delete

–ù–∞—Ö–æ–¥–∏–º –≤–µ—Ä—à–∏–Ω–∫—É $u$, —É –∫–æ—Ç–æ—Ä–æ–π $u\rightarrow x > v\rightarrow x.$  –£ $u$ –Ω–µ—Ç –ª–µ–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞. 

–ü–µ—Ä–µ–≤–µ—à–∏–≤–∞–µ–º $u$ –Ω–∞ –º–µ—Å—Ç–æ $v$, –º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π, –ø–æ—Ç–æ–º —É–¥–∞–ª—è–µ–º $v$.

```c++
void del(Node* v) {     // O(n)
    Node* u = next(v);
    
    u->x = v->x;
    // u->parent->left = v->right;  –º–± –Ω–µ –Ω–∞–¥–æ, –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ 
    u->parent = v->parent;
    u->left = v->left;
    u->right = v->right;
    
    v = u;
}
```





#### print

```c++
void print(Node*v) {  // O(n)
    if (!v->right && !v.left) 
        return;
    print(v->left);     // –≤—ã–≤–µ–¥–µ—Ç—Å—è –≤ –æ—Ç—Å–æ—Ä—Ç.–ø–æ—Ä—è–¥–∫–µ: 
    std::cout << v->x;  // —Å–Ω–∞—á–∞–ª–∞ –≤—Å–µ <x, –ø–æ—Ç–æ–º x, –ø–æ—Ç–æ–º >x
    print(v->right);
}
```





**–ï—Å–ª–∏ —Ä–∞–≤–Ω—ã–µ –∫–ª—é—á–∏:** 

1.  x ---> pair(x, id);
2. –°—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ x –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∫–µ
3. <x => –∏–¥—ë—Ç –≤ v->left;   ‚â•x => –∏–¥—ë—Ç –≤ v->right







### AVL-–¥–µ—Ä–µ–≤–æ /todo –ø—Ä–æ —Ç–µ–æ—Ä–µ–º—É

–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ BST. –ü—Ä–∏–¥—É–º–∞–Ω–æ –≤ 1962 –≥–æ–¥—É —Å–æ–≤–µ—Å—Ç–∫–∏–º –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞–º–∏ –ê–¥–µ–ª—å—Å–æ–Ω–æ–º-–í–µ–ª—å—Å–∫–∏–º (AV) –∏ –õ–∞–Ω–¥–∏—Å–æ–º (L). 



***–£—Å–ª–æ–≤–∏–µ:*** $|h(v.l) - h(v.r)| \leqslant 1,  \ \forall v$



***Th.:*** –≥–ª—É–±–∏–Ω–∞ AVL-–¥–µ—Ä–µ–≤–∞ $O(\log n)$

***–î–æ–∫-–≤–æ:***

$S_h$ -- min —á–∏—Å–ª–æ –≤–µ—Ä—à–∏–Ω –≤—ã—Å–æ—Ç—ã $h$ (–∑–¥–µ—Å—å $h$ = –∫–æ–ª-–≤–æ –≤–µ—Ä—à–∏–Ω –¥–ª—è –¥–∞–Ω–Ω–æ–π –≤—ã—Å–æ—Ç—ã)

$S_0 = 0$,  $S_1 = 1$,  $S_2 = 2$,  $S_3 = 4$  –∏ —Ç.–¥.



–î–æ–∫–∞–∂–µ–º, —á—Ç–æ $S_h = S_{h - 1} + S_{h - 2} + 1$

–í–µ—Ä—à–∏–Ω–∞ –∏–º–µ–µ—Ç –≤—ã—Å–æ—Ç—É $h$, —Ç–æ–≥–¥–∞ –∫–æ–≥–¥–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–∑ –≤—ã—Å–æ—Ç –¥–µ—Ç–µ–π —Ä–∞–≤–Ω–æ $h-1$



–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –≤—ã—Å–æ—Ç–∞ —Ä–∞—Å—Ç–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ. 



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–µ—Ä–µ–≤–æ –Ω–∞ $n$ –≤–µ—Ä—à–∏–Ω–∞—Ö. $h$ -- –≤—ã—Å–æ—Ç–∞.

$n \geqslant S_n \geqslant c \cdot \phi^h$

$\log_{\phi} n \geqslant \log_{\phi} c + h$

$h \leqslant \log_{\phi} n - \log_{\phi} c = O(\log n) $





#### rotate

##### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ $v.l.l$ –∏–ª–∏ –≤ $v.r.r$

–ü—É—Å—Ç—å $h(v.l) = h(v.r) + 2$ -- –¥–æ–±–∞–≤–∏–ª–∏ –≤ –ª–µ–≤–æ–≥–æ –≤–Ω—É–∫–∞; –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ –≤—ã—à–µ, —á–µ–º –ø—Ä–∞–≤–æ–µ

–¢–æ—á–Ω–æ –∑–Ω–∞–µ–º, —á—Ç–æ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ –Ω–µ–ø—É—Å—Ç–æ–µ. 

<img src="./pics for conspects/ALG/ALG 22-09-28 1.png" alt="ALG 22-09-28 1" style="zoom:50%;" />



##### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ $v.l.r$ –∏–ª–∏ –≤ $v.r.l$

–ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–≤–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö –≤—Ä–∞—â–µ–Ω–∏—è: —Å–Ω–∞—á–∞–ª–∞ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Å –∫–æ—Ä–Ω–µ–º $v.l$ –≤–ª–µ–≤–æ, –ø–æ—Ç–æ–º –¥–µ—Ä–µ–≤–æ —Å –∫–æ—Ä–Ω–µ–º $v$ –≤–ø—Ä–∞–≤–æ. 

![ALG 22-09-28 2](./pics for conspects/ALG/ALG 22-09-28 2.png)





##### –ö–æ–¥

```c++
add (Node* v, int x) {    // O(logn)
    if (!v)
        return new Node(x)
    if (v.x <= x)
        v.r = add(v.r, x)
    else 
        v.l = add(v.l, x)
    rebalance(v)  // O(1): –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª–∏
    return v
}
```

–ß—Ç–æ–±—ã `rebalance()` —Ä–∞–±–æ—Ç–∞–ª –∑–∞ $O(1)$, –≤ –Ω–æ–¥–∞—Ö –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `height`. 







## 22-09-28



### RBST 

Randomized Binary Search Tree



$\texttt{Def 1:}$    $BST$ –º–æ–∂–µ—Ç –±—ã—Ç—å $RBST$, –µ—Å–ª–∏ –ª—é–±–æ–π –∫–ª—é—á –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ—Ä–Ω–µ–º —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é. 

$\texttt{Def 2:}$    $RBST$ -- —ç—Ç–æ $BST$, –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –ø–æ—Ç–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∫–ª—é—á–µ–π –≤ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—É—Å—Ç–æ–µ –¥–µ—Ä–µ–≤–æ –≤ —Å–ª—É—á–∞–π–Ω–æ–π –ø–æ—Ä—è–¥–∫–µ. 



#### *Th. (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π)*

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã 

*–î–æ–∫-–≤–æ:* –≤ —Å–ª—É—á–∞–π–Ω–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ –ª—é–±–æ–π —ç–ª–µ–º–µ–Ω—Ç –±—É–¥–µ—Ç –∫–æ—Ä–Ω–µ–º —Å –≤–µ—Ä-—Ç—å—é $\frac{1}{n}$  $\Leftrightarrow$  –ª—é–±–æ–π —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ—Ä–Ω–µ–º —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –≤–µ—Ä-—Ç—å—é. –¢–æ –∂–µ —Å–∞–º–æ–µ –≤–µ—Ä–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤.  





#### *Th. (–º–∞—Ç–æ–∂–∏–¥–∞–Ω–∏–µ –¥–ª—è –≥–ª—É–±–∏–Ω—ã)* \todo

$RBST$ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –ø–æ –∫–ª—é—á–∞–º $\{ x_1,.., x_n \}$. $v_i$ -- —É–∑–µ–ª –∫–ª—é—á–∞ $x_i$. –¢–æ–≥–¥–∞ $\textnormal{E}[d(v_i)] = O(\log n)$

*–î–æ–∫-–≤–æ:*

–í—ã–±–µ—Ä–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –º–∞—Å—Å–∏–≤–∞. $x_i$ —Å—Ç–∞–ª –∫–æ—Ä–Ω–µ–º —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é $\frac{1}{n}$. 









### –î–µ–∫–∞—Ä—Ç–æ–≤–æ –¥–µ—Ä–µ–≤–æ

aka *Treap* aka *Cartesian tree*  =  $\{ \ (x_1,y_1),.., (x_n, y_n) \ \}$.

- –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º $x$
- –±–∏–Ω–∞—Ä–Ω–∞—è –∫—É—á–∞ –ø–æ –∫–æ–æ—Ä–¥–Ω–∞—Ç–∞–º $y$
- –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã $y$ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Ä–∞–Ω–¥–æ–º–Ω–æ



<img src="./pics for conspects/ALG/ALG 22-09-28 3.png" alt="ALG 22-09-28 3" style="zoom:50%;" />





#### *Th. (—Å–≤—è–∑—å –º–µ–∂–¥—É Treap –∏ RBST)*

Treap —è–≤–ª—è–µ—Ç—Å—è RBST –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º $x$

*–î–æ–∫-–≤–æ:*

–ö–æ—Ä–µ–Ω—å = $(x_i, y_i)$–± –≥–¥–µ $y_i = \min y$. –ö–æ–æ—Ä–∏–Ω–∞—Ç—ã $y$ —Ä–∞–Ω–¥–æ–º–Ω—ã–µ $\Rightarrow$ –ª—é–±–∞—è –≤–µ—Ä—à–∏–Ω–∞ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –∫–æ—Ä–Ω–µ–º —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –≤–µ—Ä-—Ç—å—é $\frac{1}{n}$. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è—Ö. 







#### Merge

–ú–µ—Ä–∂–∏–º –¥–µ—Ä–µ–≤—å—è $a$ –∏ $b$. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ: $\forall x \in a \ \leqslant \ \forall y \in b$.

<img src="./pics for conspects/ALG/ALG 22-09-28 4.png" alt="ALG 22-09-28 4" style="zoom:50%;" />

 

```c++
Node* merge(Node* a, Node* b) {
    if (!a)
        return b
    if (!b)
        return a
    if (a.y <= b.y) {
        a.r = merge(a.r, b)
            return a
    }
    b.l = merge(a, b.l)
    return b
}
```







#### Split

```c++
pair<Node*, Node*> split(Node* t, int x) {   // O(logn)
    if (!t)
        return (nullptr, nullptr)
    if (t.x <= x) {
        (a, b) = split(t.r, x)
        t.r = a
        return (t, b)
    }
    if (t.x >  x) {
        (a, b) = split(t.l, x)
        t.l = b
        return (a, t)
    }
}
```







## 22-10-05



### –£–ª—É—á—à–µ–Ω–∏—è BST

#### 1. –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

##### (a) getSum(x1, x2)

–î–∞–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä $<x, y>$. 

$\texttt{getSum(x1, x2)}$ = $\sum \limits_{x \in [x1, x2]} y$



*–†–µ—à–µ–Ω–∏–µ 1:* 

–•—Ä–∞–Ω–∏–º $RBST$. –ö–ª—é—á -- $x$, –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -- —Å—É–º–º–∞ $y$ –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ. 

$\texttt{split}$($t$, $x_1$) $\ \rightarrow \ $ $t_{<x_1}$; $t_{\geqslant x_1}$

$\texttt{split}$($t_{\geqslant x_1}, x_2$) $\ \rightarrow \ $ $t_{[x_1, x_2)}$; $t_{\geqslant x_2}$

answer = $t_{[x_1, x_2)}.\texttt{sum}$

$t_3$ = $\texttt{merge}$($t_{[x_1, x_2)}$, $t_{\geqslant x_2}$)

$t$ = $\texttt{merge}$($t_{<x_1}$, $t_3$)



*–†–µ—à–µ–Ω–∏–µ 2:*

```c++
getSum(t, qx1, qx2, cx1, cx2) 
{
    if ([qx1, qx2) && [cx1, cx2) == 0) { // –Ω–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è 
         return 0;
    }
    
    if ([cx1, cx2) && [qx1, qx2) == [cx1, cx2)) { // [cx1, cx2) –≤–Ω—É—Ç—Ä–∏ [qx1, qx2)
        return t->sum;
    }
   
    return getSum(t->l, qx1, qx2, cx1, t->x) + getSum(t->r, qx1, qx2, t->x, cx2);
}
                                     
int main() {
    getSum(root, qx1, qx2, -inf, +inf);
}
```

–†–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(\log n)$: –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –±—É–¥–µ—Ç –ø–æ—Å–µ—â–µ–Ω–æ –Ω–µ –±–æ–ª—å—à–µ 4 –≤–µ—Ä—à–∏–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–≤–µ—Ç–≤–ª—è–µ–º—Å—è –º–∞–∫—Å–∏–º—É–º –æ—Ç –¥–≤—É—Ö –≤–µ—Ä—à–∏–Ω. –¢–æ–≥–¥–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã = $4 \cdot \texttt{height} = 4 \log n$.





##### (b) assignValue(x1, x2, y)

$\texttt{split}$($t$, $x_1$) $\ \rightarrow \ $ $t_{<x_1}$; $t_{\geqslant x_1}$

$\texttt{split}$($t_{\geqslant x_1}, x_2$) $\ \rightarrow \ $ $t_{[x_1, x_2)}$; $t_{\geqslant x_2}$

–õ–µ–Ω–∏–≤–æ –º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ  $t_{[x_1, x_2)}$ —Å –ø–æ–º–æ—â—å—é $\texttt{push}$:

```c++
Node::push() 
{
    if (toAssign == -inf) {
        return;
    }
    if (l) {
        l->toAssign = toAssign
        l->y = toAssign
    }
    if (r) {
        r->toAssign = toAssign
        l->y = toAssign
    }
    toAssign = -inf;
}
```

–ó–Ω–∞—á–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ —Å –∫–æ—Ä–Ω–µ–º $t_{[x_1, x_2)}$ –º–µ–Ω—è—é—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–≤–æ–≥–æ $\texttt{merge}$. 





#### 2. –î–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–µ—è–≤–Ω–æ–º—É –∫–ª—é—á—É \todo

##### (a) get_kth_element(k)



(b) 







## 22-10-19

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ –æ—Ç—Ä–µ–∑–∫–æ–≤ 

#### –°–ø–æ—Å–æ–± 1: –º–µ–Ω—è–µ–º `vector` –Ω–∞ –º–∞–ø—É

–í–æ–∑—å–º—ë–º –æ–±—ã—á–Ω–æ–µ –î–û, –∑–∞–º–µ–Ω–∏–º `vector<int> ST`, –≤ –∫–æ—Ç–æ—Ä–æ–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞, –Ω–∞ `unordered_map<ll, int> ST`. 

–ó–∞ $q$ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–æ–∑–¥–∞–¥–∏–º $\leqslant \min (q \log n, n)$.

–ü–ª–∞—Ç–∏–º –≤—Ä–µ–º–µ–Ω–µ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–∞–ø–∞ –Ω–∏–∫—É–¥–∞ –Ω–µ —Å–ø–µ—à–∏—Ç. 



#### –°–ø–æ—Å–æ–± 2: –Ω–µ –º–∞—Å—Å–∏–≤, –∞ —É–∫–∞–∑–∞—Ç–µ–ª–∏

–•—Ä–∞–Ω–∏–º –î–û –Ω–µ –Ω–∞ –º–∞—Å—Å–∏–≤–µ, –∞ –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è—Ö. –°–æ–∑–¥–∞—ë–º –≤–µ—Ä—à–∏–Ω—ã, —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –æ–Ω–∏ –Ω—É–∂–Ω—ã. –í–µ—Ä—à–∏–Ω—ã –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö $get$. 

–í–µ—Ä—à–∏–Ω—ã –Ω–µ—Ç $\Rightarrow$ –∑–Ω–∞—á–µ–Ω–∏–µ = 0



#### –°–ø–æ—Å–æ–∫ 3: —Å–∂–∞—Ç–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

–¢—Ä–µ–±—É–µ–º, —á—Ç–æ–±—ã –∑–∞–¥–∞—á–∞ –±—ã–ª–∞ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω–µ. 

$q$ –∑–∞–ø—Ä–æ—Å–æ–≤. –°–æ—Ä—Ç–∏—Ä—É–µ–º $2q$ —á–∏—Å–µ–ª, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã $0, 1, 2, ..$





### –î–≤—É–º–µ—Ä–Ω—ã–µ (–º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ) –∑–∞–ø—Ä–æ—Å—ã

–ó–∞–¥–∞—á–∞ 1: 

–î–∞–Ω –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã $n$. –ó–∞–ø—Ä–æ—Å—ã –≤–∏–¥–∞ `get(l, r, d, u)` -- –Ω–∞–π—Ç–∏ #—á–∏—Å–µ–ª –Ω–∞ $[l, r)$ : –∏—Ö –≤–µ–ª–∏—á–∏–Ω—ã $\in [d, u)$



–ó–∞–¥–∞—á–∞ 2: 

–î–∞–Ω–æ $n$ —Ç–æ—á–µ–∫ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏. –ó–∞—Ä–æ—Å—ã `get(l, r, d, u)` -- #—Ç–æ—á–µ–∫ –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ $\{ \ i \ : \ x_i \in [l, r), \ y_i \in [d, u) \ \}$



 ***–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:*** –∑–∞–¥–∞—á–∞ 1 –∏ –∑–∞–¥–∞—á–∞ 2 -- —ç—Ç–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ.

***–î–æ–∫-–≤–æ:***

$1 \Rightarrow 2:$   $a[i] \ \rightarrow \ (i, a[i])$

$2 \Rightarrow 1:$   —Å–¥–µ–ª–∞–µ–º —Å–∂–∞—Ç–∏–µ —Ç–æ—á–µ–∫ –ø–æ $x_i$. –ü–æ–ª—É—á–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã $\{ x_i \} = \{0, 1, 2, ...\}$ -- —ç—Ç–æ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –º–∞—Å—Å–∏–≤–∞









### –î–µ—Ä–µ–≤–æ mergeSort

–î–µ—Ä–µ–≤–æ –æ—Ç—Ä–µ–∑–∫–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–≤

<img src="./pics for conspects/ALG/ALG 22-10-19 1.png" alt="ALG 22-10-19 1" style="zoom:50%;" />

–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞ $O(n \log n)$ —Å –ø–æ–º–æ—â—å—é `mergeSort` (–æ–±—ã—á–Ω–æ–µ –î–û –∑–∞ $O(n)$). 

–ó–∞–¥–∞—á–∞ 1:  –í—Ä–µ–º—è = $\underset{O(\log n)}{\# –∫—É—Å–∫–æ–≤} \cdot \underset{2 \textnormal{ } –±–∏–Ω–ø–æ–∏—Å–∫–∞}{T(–æ—Ç–≤–µ—Ç \textnormal{ } –≤ \textnormal{ } –∫—É—Å–∫–µ)} = O(\log^2 n)$ 







## 22-10-26

### Sparse table

–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ -- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –∑–∞ $O(1)$ —Å –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–æ–º –∑–∞ $ O(n \log ‚Å°n) $ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏.

–ü–æ —Å—É—Ç–∏, —Å—á–∏—Ç–∞–µ–º –º–∏–Ω–∏–º—É–º—ã –Ω–∞ –∫–∞–∂–¥–æ–º –æ—Ç—Ä–µ–∑–∫–µ –¥–ª–∏–Ω—ã $2^{k}$.

$dp[i][k] = \min \{ \ a_i, a_{i+1},..., a_{i + 2^k - 1} \ \}$

```c++
for i = 0..n:
    dp[i][0] = parent[i]

for k = 1..logn:
    for v = 0..n:
        dp[v][k] = min(dp[v][k - 1], dp[v + 2^{k-1}][k-1])
```



–ó–∞–ø—Ä–æ—Å $\texttt{get(l, r)}$:

–ù–∞—Ö–æ–¥–∏–º —Å—Ç–µ–ø–µ–Ω—å $j$ —Ç–∞–∫—É—é, —á—Ç–æ $2^j \leqslant r - l$. –¢–æ–≥–¥–∞ –º–∏–Ω–∏–º—É–º –Ω–∞ $[l , r]$ = $\texttt{min(dp[l][j], dp[x][j])}$  ($\texttt{x} = r - 2^j$).

<img src="./pics for conspects/ALG/ALG 22-10-26 1.png" alt="ALG 22-10-26 1" style="zoom:80%;" />

–ß—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–ª –∑–∞ $O(1)$, –ø—Ä–µ–ø–æ–¥—Å—á–∏—Ç–∞–µ–º —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏. –¢–∏–ø–∞ $\texttt{k = log[r - l]}$. 









### LCA & –î–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã

#### isAncestor

–ó–∞–ø—É—Å–∫–∞–µ–º –¥—Ñ—Å –æ—Ç –∫–æ—Ä–Ω—è –∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ–º –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞. –¢–æ–≥–¥–∞ 

```c++
isAncector(a, b) {
    if (tin[a] <= tin[b] && tout[a] >= tout[b])
    return true;
    return false;
}
```

*–î–æ–∫-–≤–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏:* 

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤–µ—Ä—à–∏–Ω–∫—É . –í–µ—Ä—à–∏–Ω–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö $\texttt{tin} \geqslant \texttt{tin[a]}$ , –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –±–æ–ª–µ–µ –ø—Ä–∞–≤—ã—Ö –≤–µ—Ç–∫–∞—Ö –∏ —É –¥–µ—Ç–µ–π . –í–µ—Ä—à–∏–Ω–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö $\texttt{tout} \leqslant \texttt{tout[a]}$ , –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –±–æ–ª–µ–µ –ª–µ–≤—ã—Ö –≤–µ—Ç–∫–∞—Ö –∏ —É –¥–µ—Ç–µ–π . –í –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –¥–µ—Ç–∏ $a$.



#### LCA

```c++
lca(v, u) {
	if (isAncestor(v, u)) {
		return v
	}
	for (int k = logn; k >= 0; --k) {
		tmp = up[v][k]
		if (!isAncestor(tmp, u)) {      // –µ—Å–ª–∏ –Ω–µ –ø—Ä—ã–≥–Ω—É–ª–∏ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ,
			v = tmp                    // —Ç–æ –º–µ–Ω—è–µ–º v
		}
	}	
    return up[v][0]
}
```







### LA (level ancestor)

#### Online

–ó–∞–ø—Ä–æ—Å `LA(v, k)` ‚Äì –ø–æ–¥–Ω—è—Ç—å—Å—è –≤ –¥–µ—Ä–µ–≤–µ –æ—Ç –≤–µ—Ä—à–∏–Ω—ã `v` –Ω–∞ `k` —à–∞–≥–æ–≤ –≤–≤–µ—Ä—Ö.

–£–∂–µ —É–º–µ–µ–º —Ä–µ—à–∞—Ç—å –∑–∞ $<n \log n, \ \log n>$ –¥–≤–æ–∏—á–Ω—ã–º–∏ –ø–æ–¥—ä—ë–º–∞–º–∏. 



#### Offline

–ü—Ä–æ–π–¥–µ–º –¥—Ñ—Å–æ–º –∏ –±—É–¥–µ–º –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –ø—É—Ç—å. –î–ª—è –≤–µ—Ä—à–∏–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ø—É—Ç—å –æ—Ç –∫–æ—Ä–Ω—è, –º–æ–∂–Ω–æ –∑–∞ $O(1)$ —É–∑–Ω–∞—Ç—å –ø—Ä–µ–¥–∫–∞ –Ω–∞ $k$-–æ–º —É—Ä–æ–≤–Ω–µ. 







### –ê–ª–≥–æ—Ä–∏—Ç–º –í–∏—à–∫–∏–Ω–∞

–†–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $<n, \log n>$. 

–í—ã–ø–∏—à–µ–º –≤—ã—Å–æ—Ç—ã –≠–π–ª–µ—Ä–æ–≤–∞ –æ–±—Ö–æ–¥–∞ –≤—Ç–æ—Ä–æ–≥–æ —Ç–∏–ø–∞. –ü–æ–ª—É—á–∏–º –º–∞—Å—Å–∏–≤ `height`. 

–î–ª—è –∑–∞–ø—Ä–æ—Å–∞ `LA(v, k)` –∑–Ω–∞–µ–º –∏–Ω–¥–µ–∫—Å `j` : `height[j] = v`. –ù–∞–π–¥–µ–º –∏–Ω–¥–µ—Å `max i`  :  `i <= j && height[i] = height[j] - k`. 

<img src="./pics for conspects/ALG/ALG 22-11-02 4.png" alt="ALG 22-11-02 4" style="zoom:70%;" />

–ß—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å, –∏—Å–ø–æ–ª—å–∑—É–µ–º –î–û –∑–∞ $<n, \ \log n>$. –í –≤–µ—Ä—à–∏–Ω–∫–µ —Ö—Ä–∞–Ω–∏–º –º–∞–∫—Å–∏–º—É–º. 











## 22-11-02

### RMQ $\pm$ 1

$\forall i \ : \ |a_i - a_{i+1}| = 1$. –†–∞–±–æ—Ç–∞–µ—Ç –∑–∞ `<n, 1>`. 



–†–∞–∑–æ–±—å—ë–º –º–∞—Å—Å–∏–≤ –Ω–∞ –±–ª–æ–∫–∏ –¥–ª–∏–Ω—ã $B = \frac{\log n}{2}$. 

–í –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ –Ω–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º—É–º (–º–æ–∂–Ω–æ –∑–∞ $O(n)$), —Å—Ç—Ä–æ–∏–º –Ω–∞ –Ω–∏—Ö sparse table –∑–∞ $O(\frac{2n}{\log n} \log \log \frac{2n}{\log n}) = O(n)$. 



–ë–ª–æ–∫ –º–æ–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∫–∞–∫–æ–Ω–∏—á–µ—Å–∫–æ–º—É –≤–∏–¥—É, –≤—ã—á—Ç—è –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç: $7, 8, 7, 6, 5 \ \rightarrow \ 0, 1, 0, -1, -2$

–ü—Ä–µ–¥–ø–æ–¥—Å—á–∏—Ç–∞–µ–º –º–∏–Ω–∏–º—É–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ç–∞–∫–∏—Ö —Ç–∏–ø–æ–≤.

```c++
for (type in types)
    for (l = 0 .. B)
        for (r = l .. B) {
            m = (r + l) / 2
            precalc[type][l][r] = min(precalc[type >> m][l][m], precalc[type & (1 << m - 1)][m][r]) // –Ω—É —Ç–∏–ø–∞ 
        }
```

–†–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(2^B B^2) = O(\sqrt{n} \log^2 n)$.



–ó–∞–ø—Ä–æ—Å —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ö–≤–æ—Å—Ç –≤ –Ω–∞—á–∞–ª–µ + –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫–æ–≤ + —Ö–≤–æ—Å—Ç –≤ –∫–æ–Ω—Ü–µ. –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –Ω–µ–≥–æ –º–æ–∂–Ω–æ –∑–∞ $O(1)$. 









### –§–ö–ë

–•–æ—Ç–∏–º `RMQ` –∑–∞ `<n, 1>` –Ω–∞ –º–∞—Å—Å–∏–≤–µ



$\texttt{RMQ} \ \underset{1}{\rightarrow} \ \texttt{LCA} \ \underset{2}{\rightarrow} \ \texttt{RMQ} \pm 1 $



1. $\texttt{RMQ} \ \underset{}{\rightarrow} \ \texttt{LCA}$ 

   –°—Ç—Ä–æ–∏–º –¥–µ–∫–∞—Ä—Ç–∞—á –ø–æ –º–∞—Å—Å–∏–≤—É –∑–∞ $O(n)$.   $\texttt{a[i]} \rightarrow \texttt{<i, a[i]>}$

   –ü–æ –∏–Ω–¥–µ–∫—Å–∞–º —ç—Ç–æ BST (*aka* –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç), –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º -- –±–∏–Ω –∫—É—á–∞. 

   –ö–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∑–∞ $O(n)$? –ü—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ –º–∞—Å—Å–∏–≤—É. –í –¥–µ—Ä–µ–≤–µ –±—É–¥–µ–º –≤—Å–µ–≥–¥–∞ –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ —Å–∞–º–æ–º—É –ø—Ä–∞–≤–æ–º—É –ø—É—Ç–∏ (–∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –µ–≥–æ –∫–æ–Ω–µ—Ü). –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–µ–Ω—å—à–µ, —á–µ–º –Ω–∞—á–∞–ª–æ –ø—É—Ç–∏, —Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –≤–µ—Ç–∫—É —Å–ø—Ä–∞–≤–∞ –æ—Ç –≤—Å–µ—Ö –≤–µ—Ç–æ–∫ –Ω–∞—á–∞–ª–∞ –ø—É—Ç–∏ (—Ç–µ–ø–µ—Ä—å –Ω–∞—á–∞–ª–æ —Å–∞–º–æ–≥–æ –ø—Ä–∞–≤–æ–≥–æ –ø—É—Ç–∏ –ø–æ–º–µ–Ω—è–ª–æ—Å—å).

   <img src="./pics for conspects/ALG/ALG 22-11-02 2.png" alt="ALG 22-11-02 2" style="zoom:50%;" />

   

   *LCA* –¥–ª—è –≤–µ—Ä—à–∏–Ω–æ–∫ $v$ –∏ $u$ = $\min$ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ $[v.key, u.key]$ 

   *–î–æ–∫-–≤–æ:*

   - $LCA \in $ –æ—Ç—Ä–µ–∑–∫—É

   <img src="./pics for conspects/ALG/ALG 22-11-02 1.png" alt="ALG 22-11-02 1" style="zoom:35%;" />

   - $\forall i, \ i \in [l, r) \ : \ (i, a[i]) \in subtree(lca) \ \Rightarrow \ lca.value \leqslant a[i]$

     $\Rightarrow$ $lca$ = $\min$ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ 

   

   

   

2. $\texttt{LCA} \ \underset{}{\rightarrow} \ \texttt{RMQ} \pm 1 $

   **(1)** –≠–π–ª–µ—Ä–æ–≤ –æ–±—Ö–æ–¥ –≤—Ç–æ—Ä–æ–≥–æ —Ç–∏–ø–∞ (–≤—ã–ø–∏—Å—ã–≤–∞–µ–º –≤–µ—Ä—à–∏–Ω—É –∏ –≤—ã—Å–æ—Ç—É)

   <img src="./pics for conspects/ALG/ALG 22-11-02 3.png" alt="ALG 22-11-02 3" style="zoom:50%;" />

–ü–æ–ª—É—á–∞–µ–º –º–∞—Å—Å–∏–≤ $\texttt{h}$, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ $= \pm 1$. 

–í—ã–±–∏—Ä–∞–µ–º –≤ –Ω–µ–º –ª—é–±–æ–µ –∏–∑ –≤—Ö–æ–∂–¥–µ–Ω–∏–π –≤–µ—Ä—à–∏–Ω–æ–∫, –º–∏–Ω —á–∏—Å–ª–æ –º–µ–∂–¥—É –Ω–∏–º–∏ $= lca$ —ç—Ç–∏—Ö –≤–µ—Ä—à–∏–Ω–æ–∫.



**(2)** –í $\texttt{h}$ –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ $(x, \pm 1, ..., \pm 1)$, –≥–¥–µ $x$ -- —á–∏—Å–ª–æ –≤ –Ω–∞—á–∞–ª–µ –æ—Ç—Ä–µ–∑–∫–∞. 

–•–æ—Ç–∏–º –¥–ª—è –ª—é–±–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞ $[l, r)$ –±—ã—Å—Ç—Ä–æ —É–∑–Ω–∞–≤–∞—Ç—å —Ç–∏–ø –∏ –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º. 



$k = \frac{\log n}{2}$. –°—Ç—Ä–æ–∏–º sparse table. 

–í—Å–µ–≥–æ –µ—Å—Ç—å $2^0 + 2^1 + ... + 2^{k} \leqslant 2^{k+1} = O(\sqrt{n})$ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤.

–ü–µ—Ä–µ–±–µ—Ä–µ–º –≤—Å–µ –æ—Ç—Ä–µ–∑–∫–∏ –∏ –Ω–∞–π–¥–µ–º –≤ –Ω–∏—Ö –º–∏–Ω–∏–º—É–º—ã.  

```c++
for (mask = 0..2^{k+1})
    for (l = 0..k)
        for (r = 0..k)
        	precalc[type][l][r] = min elem in [l, r];
```

 









## 22-11-09

### –¶–µ–Ω—Ç—Ä–æ–∏–¥–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è 

–¶–µ–Ω—Ç—Ä–æ–∏–¥ -- –≤–µ—Ä—à–∏–Ω–∫–∞, –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ —Ä–∞—Å–ø–∞–¥–∞–µ—Ç—Å—è –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–∑–º–µ—Ä–∞ $\leqslant \frac{n}{2}$.  –Ø–≤–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –Ω—É–∂–Ω–æ, –∏—Ö –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ —É—Ä–æ–≤–Ω—é –≤–µ—Ä—à–∏–Ω–æ–∫.

$d_v$ -- —É—Ä–æ–≤–µ–Ω—å –≤–µ—Ä—à–∏–Ω–∫–∏ $v$, $p_v$ -- —Ä–æ–¥–∏—Ç–µ–ª—å —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞ $v$. 

 

–î–ª—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–Ω–æ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –Ω—É–∂–Ω–æ $\Theta (n)$ –ø–æ–º—è—Ç–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤—ã $p$ –∏ $d$. 

–ì–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞ $\leqslant \log n$. 



`build` —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(n \log n)$. 

```c++
// —Å—á–∏—Ç–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–≤—è–∑–Ω–æ—Å—Ç–∏
int calc_size(int v, int parent = -1) {
    int size = 1;
    for (int x: graph[v])
        if (x != parent && d[x] == -1)
            size += calc_size(x, v);
    return size;
}

// –ó–Ω–∞—è —Ä–∞–∑–º–µ—Ä –¥–µ—Ä–µ–≤–∞ ùëõ, —Å—á–∏—Ç–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏—â–µ–º —Ü–µ–Ω—Ç—Ä–æ–∏–¥
int get_centroid(int v, int parent, int n, int &centroid) {
    int size = 1;
    for (int x: graph[v])
        if (x != parent && d[x] == -1)
            size += get_centroid(x, v, n, centroid);
    if (size * 2 >= n && centroid == -1)
        centroid = v;
    return size;

}

void build(int v, int parent, int depth) {
    int centroid = -1;
    get_centroid(v, -1, calc_size(v), centroid);
    d[centroid] = depth;
    p[centroid] = parent;
    for (int x: g[centroid])
        if (d[x] == -1)
            build(x, centroid, depth + 1);
}

d = vector<int>(n, -1);
p = vector<int>(n, -1);
build (0 , -1 , 0);
```

 

$v$ -- –ø—Ä–µ–¥–æ–∫ $a$ –∏ $b$, —Ç–∞–∫–æ–π —á—Ç–æ $a, b \in C(v)$. –ú–æ–∂–µ–º –Ω–∞–π—Ç–∏ –∑–∞ $O(\log n)$

–ú–∏–Ω–∏–º—É–º –Ω–∞ –ø—É—Ç–∏ –º–µ–∂–¥—É $a$ –∏ $b$ —Ä–∞–≤–µ–Ω $\min (f[v][a], f[v][b])$. 









### MST

Minimal Spanning Tree 





### Th. (–ª–µ–º–º–∞ –æ —Ä–∞–∑—Ä–µ–∑–µ)

$V$ -- –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω, $E$ -- –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–µ. 

$V = A \ \sqcup \ B$ -- —Ä–∞–∑—Ä–µ–∑ –≥—Ä–∞—Ñ–∞

$T \subset E \ : \ T \textnormal{\ –Ω–µ \ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç \ —Ä–∞–∑—Ä–µ–∑ \ } \ ({\small \nexists e \in T \ : \ e=(ab), a \in A, b \in B})$

–¢–æ–≥–¥–∞ $\exist MST \ T_0 \ : \ T \subset T_0$



*–î–æ–∫-–≤–æ:*

$e$ -- —Ä–µ–±—Ä–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –∏–∑ —Ä–∞–∑—Ä–µ–∑–∞ ( ${\small e = (ab), a \in A, b \in B \ \and \ \forall e' = (a'b'), a' \in A, b' \in B \ : \ weight(e') \geqslant weight(e)}$ )

–¢–æ–≥–¥–∞ $e$ -- –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–µ–±—Ä–æ –¥–ª—è $T$, —Ç. –µ. $\exist \ MST \  T_1 \ : \ T \cup \{e\} \subset T_1$



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º $T_0$.

1. $e \in T_0 \ \Rightarrow \ T_1 := T_0$

2. $e \notin T_0$. –¢–æ–≥–¥–∞ –≤ $T_0$ –µ—Å—Ç—å –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–Ω–æ —Ä–µ–±—Ä–æ $e'=(a'b')$, –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–µ–µ —Ä–∞–∑—Ä–µ–∑ (–∏–Ω–∞—á–µ $T_0$ –Ω–µ —Å–≤—è–∑–Ω–æ–µ, –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ). 

   $T_1 := T_0 / \{ e' \} \cup \{ e \}$

   $\left . \begin{array}{r} weight(T_1) = weight(T_0) - weight(e') + weight(e) \\ weight(e') \geqslant weight(e) \end{array} \right \} \ \Rightarrow \ weight(T_1) \leqslant weight(T_0)$

   $T_1$ -- –¥–µ—Ä–µ–≤–æ ($|T_1| = |T_0| - 1 + 1 = n - 1$)

   –ü—É—Ç—å –º–µ–∂–¥—É $a'$ –∏ $b'$ –≤—Å–µ —ë—â—ë —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Ä–∞–≤–µ–Ω $a' \rightsquigarrow a \underset{e}{\rightarrow} b \rightsquigarrow b'$. –ï—Å–ª–∏ –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã –Ω–µ—Ç –ø—É—Ç–∏ –∏–∑ $a'$ –≤ $a$, —Ç–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ $T_0$ –Ω–µ –±—ã–ª —Å–≤—è–∑–Ω—ã–π, –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ.  

3. *–£—Ç–≤. 1*: $T_1 - MST$  ( $|T_1| = n-1$ –∏ $T_1$ —Å–≤—è–∑–Ω–æ–µ )

   

   *–£—Ç–≤. 2*: $T \cup \{ e\} \subset T_1$

   *–î–æ–∫-–≤–æ:*

   $e \in T_1$ 

   –í $T$ –Ω–µ –±—ã–ª–æ —Ä–µ–±–µ—Ä –∏–∑ —Ä–∞–∑—Ä–µ–∑–∞ –ø–æ —É—Å–ª–æ–≤–∏—é $\Rightarrow \ e' \notin T \ \Rightarrow \ T \subset T_0 / \{ e'\} \ \Rightarrow \  T \subset T_1$

   



***–°–º—ã—Å–ª –ª–µ–º–º—ã:*** 

–ï—Å–ª–∏ –µ—Å—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –¥–æ $MST$, —Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –±—Ä–∞—Ç—å —Ä–µ–±—Ä–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞, —Å–æ–µ–¥–∏–Ω—è—é—â–µ–µ –¥–≤–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã. 











### –ê–ª–≥–æ—Ä–∏—Ç–º –ü—Ä–∏–º–∞

–°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ $T$ —Å –Ω—É–ª—è. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤ $–¢$ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–¥–Ω–∞ –≤–µ—Ä—à–∏–Ω–∫–∞.

–î–ª—è –≤–µ—Ä—à–∏–Ω–∫–∏ $u$ –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º —Ä—ë–±—Ä–∞. –í—ã–±–∏—Ä–∞–µ–º —Ç–∞–∫–æ–µ $(u, v)$, —á—Ç–æ:
- $w( (u,v) ) = \min$ 
- $v \notin T$

–î–µ–ª–∞–µ–º —Ç–∞–∫ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –≤ $T$ –Ω–µ –±—É–¥—É—Ç –≤–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –≤–µ—Ä—à–∏–Ω–∫–∏

–†–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(V^2 + E)$ –Ω–∞ –º–∞—Å—Å–∏–≤–µ, $O(E \log V)$ –Ω–∞ –±–∏–Ω –∫—É—á–µ, $O(V \log V + E)$ –Ω–∞ –§–∏–±. –∫—É—á–µ. 

```c++
int Prim(std::vector<std::vector<int>> &g) {
    int res = 0;
    int cur = 0;
    for (int repeat = 1; repeat < n; ++repeat) {
        for (int j = 1; j < n; ++j) {
            if (!used[j] && g[cur][j] < dist[j]) {
                dist[j] = g[cur][j];
            }
        }
        int min = INT32_MAX;
        for (int j = 0; j < n; ++j)
            if (!used[j] && dist[j] < min) {
                min = dist[j];
                cur = j;
            }
        used[cur] = true;
        res += min;
    }
    return res;
}
```







### –ê–ª–≥–æ—Ä–∏—Ç–º –ö—Ä–∞—Å–∫–∞–ª–∞

–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ MST –≤ —Å–≤—è–∑–Ω–æ–º –≥—Ä–∞—Ñ–µ 

–°—Ç—Ä–æ–∏–º –º—Å—Ç —Å –Ω—É–ª—è. –°–Ω–∞—á–∞–ª–∞ —ç—Ç–æ –ø—É—Å—Ç–æ–π –≥—Ä–∞—Ñ $T$. –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä—ë–±—Ä–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é, –ø–æ–ª—É—á–∞–µ–º –º–∞—Å—Å–∏–≤ `Edges`. 

–î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–±—Ä–æ, –µ—Å–ª–∏ –æ–Ω–æ –ª–µ–∂–∏—Ç –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∫–æ–π $\in T$ –∏ –≤–µ—Ä—à–∏–Ω–∫–æ–π $\notin T$.

```c++
std::vector<int> parent(n, -1);
std::vector<int> rank(n, 0);  // –Ω—É —Ç–∏–ø–∞ –≤—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞

int find_set(int v) {
    if (parent[v] == v) {
        return v;
    }
    return parent[v] = find_set(parent[v]);
}

void union_set(int a, int b) {
    int v_a = find_set(a);
    int v_b = find_set(b);
    if (v_a == v_b) {
        return;
    }
    if (rank[v_a] < rank[v_b]) {
        std::swap(v_a, v_b);
    }
    parent[v_b] = v_a;
    if (rank[v_a] == rank[v_b]) {
        ++rank[v_a];
    }
}

int kraskal(std::set<std::pair<int, std::pair<int, int>>> &Edges) {
    int cost = 0;
    for (const auto &edge : Edges) {
        int w = edge.first, u = edge.second.first, v = edge.second.second;
        if (find_set(u) != find_set(v)) {
            union_set(u, v);
            cost += w;
        }
    }
    return cost;
}
```

`find_set()` –∑–∞ $O(\log n)$, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞ (aka rank) –Ω–µ –±–æ–ª—å—à–µ $\log n$.

`union_set()` –º–æ–∂–Ω–æ –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞ $O(1)$.





#### –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞–∑—Ä–µ–∑ –≥—Ä–∞—Ñ–∞: $A \subset V$ && $B = V / A$. 

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ $T = \{ \varnothing \}$. –ë—É–¥–µ–º –Ω–∞–±–∏—Ä–∞—Ç—å —Ä—ë–±—Ä–∞  –≤ $T$. 

$e$ -- —Ä–µ–±—Ä–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞, —Å–æ–µ–¥–∏–Ω—è—é—â–µ–µ $a \in A$ –∏ $b \in B$. –†—ë–±—Ä–∞ –º–µ–Ω—å—à–µ–≥–æ –≤–µ—Å–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ª–∏–±–æ –≤ $A$, –ª–∏–±–æ –≤ $B$ $\Rightarrow$ –∏—Ö –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –±—Ä–∞—Ç—å. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä—ë–±—Ä–∞ –º–µ–∂–¥—É $A$ –∏ $B$ –∏–º–µ—é—Ç –±–æ–ª—å—à–∏–π –≤–µ—Å. –ó–Ω–∞—á–∏—Ç $e$ -- –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–µ–±—Ä–æ, –µ–≥–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ $T$.

–ï—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ $T$ -- –Ω–µ –¥–µ—Ä–µ–≤–æ (—Ç.–µ. –Ω–µ —Å–≤—è–∑–Ω–æ), —Ç–æ –≥—Ä–∞—Ñ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª –Ω–µ—Å–≤—è–∑–Ω—ã–π, –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ. 

$\left . \begin{array}{r} T - –¥–µ—Ä–µ–≤–æ \\ T \subseteq MST \end{array} \right \} \ \Longrightarrow \ T = MST$











## 22-11-16

### DSU

DSU -- –°–∏—Å—Ç–µ–º–∞ –ù–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ú–Ω–æ–∂–µ—Å—Ç–≤

–£–º–µ–µ—Ç:

- `init(n)`  --  —Å–æ–∑–¥–∞—Ç—å $n$ –º–Ω–æ–∂–µ—Å—Ç–≤ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ 
- `get(a)`  --  —É–∑–Ω–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ª–µ–∂–∏—Ç $a$
- `join(a, b)`  --  –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ª–µ–∂–∞—Ç $–∞$ –∏ $b$



#### DSU –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö

```c++
vector<set> sets;
vector<int> id;

void init(int n) {   // O(n)
    for (int i = 1..n) {
        id[i] = i;
        sets[i].insert(i);
    }
}

int get(int a) {  // O(1)
    return id[a];
}

void join(int a, int b) {  
    if (sets[id[a]].size() < sets[id[b]].size()) 
        std::swap(a, b);
    for (int x : sets[id[b]]) {
        id[x] = id[a];
        // sets[id[b]].erase(x);
        sets[id[a]].insert(x);
    }
}
```





##### Th. (c—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã join) \todo

–°—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö `join` –Ω–µ –±–æ–ª—å—à–µ $n \log n$. 

*–î–æ–∫-–≤–æ:*

–ü—É—Å—Ç—å $x$ —Å–µ–π—á–∞—Å –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è $\Rightarrow$ —Ä–∞–∑–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –∂–∏–≤—ë—Ç $x$, —É–≤–µ–ª–∏—á–∏–ª—Å—è –º–∏–Ω–∏–º—É–º –≤–¥–≤–æ–µ. –î–ª—è –∫–∞–∂–¥–æ–≥–æ $x$ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –Ω–µ –±–æ–ª–µ–µ $\log n$ —Ç–∞–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π. wtf 







#### DSU –Ω–∞ –¥–µ—Ä–µ–≤—å—è—Ö 

–ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: 

```c++
vector<int> p;

void init(int n) {
    for (int i = 1..n) {
        p[i] = i;
    }
}

int get(int a) {
    return p[a] == a ? a : get(p[a]);
}

int join(int a, int b) {
    pa = get(a);
    pb = get(b);
    p[pb] = pa;
}
```



##### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. –°–∂–∞—Ç–∏–µ –ø—É—Ç–µ–π -- –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—à–∏–Ω–æ–∫ –∫–æ—Ä–Ω—é

   ```c++
   int get(int a) {
       if (p[a] == a)
           return a;
       return p[a] = get(p[a]);
   }
   ```

   

2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–Ω–≥–æ–≤ –¥–ª—è –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞–Ω–∏—è –º–µ–Ω—å—à–µ–≥–æ –¥–µ—Ä–µ–≤–∞ –∫ –±–æ–ª—å—à–µ–º—É.

   –†–∞–Ω–≥ –≤–µ—Ä—à–∏–Ω—ã ‚Äì –≥–ª—É–±–∏–Ω–∞ –ø–æ–¥–¥–µ—Ä–µ–≤–∞, –µ—Å–ª–∏ –±—ã –Ω–µ –±—ã–ª–æ —Å–∂–∞—Ç–∏—è –ø—É—Ç–µ–π.

   ```c++
   vector<int> rank;
   
   void init(int n) {
       for (int i = 1..n) {
           p[i] = i;
           rank[i] = 0;
       }
   }
   
   join(a, b) { // O(logn)
       pa = get(a);
       pb = get(b);
       if (rank[pa] < rank[pb])
       	std::swap(pa, pb);
       p[pb] = pa;
       if (rank[pa] == rank[pb])
       rank[pa]++;
   }
   ```







##### Th. (–ø—Ä–æ —Ä–∞–∑–º–µ—Ä –ø–æ–¥–¥–µ—Ä–µ–≤–∞)

–ï—Å–ª–∏ —É $v$ —Ä–∞–Ω–≥ $k$, —Ç–æ –µ—ë –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Ä–∞–∑–º–µ—Ä–∞ $\geqslant 2^k$



*–î–æ–∫-–≤–æ:*

–ë–∞–∑–∞: $k=0$. –†–∞–∑–º–µ—Ä –¥–µ—Ä–µ–≤–∞ $=1$.

–ü–µ—Ä–µ—Ö–æ–¥: 

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ä–µ–≤–æ —Ä–∞–Ω–≥–∞ $k+1$, –Ω—É–∂–Ω—ã –¥–ª—è –¥–µ—Ä–µ–≤–∞ —Ä–∞–Ω–≥–∞ $k$. –ü–æ–¥–≤–µ—à–∏–≤–∞–µ–º –¥–µ—Ä–µ–≤–æ —Å –∫–æ—Ä–Ω–µ–º $u$ –∫ –¥–µ—Ä–µ–≤—É —Å –∫–æ—Ä–Ω–µ–º $v$.

$\textnormal{\small –ù–æ–≤—ã–π \ —Ä–∞–∑–º–µ—Ä \ –¥–µ—Ä–µ–≤–∞ \ —Å \ –∫–æ—Ä–Ω–µ–º \ } v = \underbrace{\textnormal{\small —Å—Ç–∞—Ä—ã–π \ —Ä–∞–∑–º–µ—Ä \ –¥–µ—Ä–µ–≤–∞ \ —Å \ –∫–æ—Ä–Ω–µ–º \ } v}_{\geqslant 2^k ({–ø–æ \ –ø—Ä–µ–¥–ø. \ –∏–Ω–¥.})} + \underbrace{ \textnormal{\small —Ä–∞–∑–º–µ—Ä \ –¥–µ—Ä–µ–≤–∞ \ —Å \ –∫–æ—Ä–Ω–µ–º \ } u}_{\geqslant 2^k (–ø–æ \ –ø—Ä–µ–¥–ø. –∏–Ω–¥.)} \geqslant 2^{k+1}$







##### Th. (–≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã join –∏ get)

`join` –∏ `get` —Ä–∞–±–æ—Ç–∞—é—Ç –∑–∞ $O(\log n)$. 



*–î–æ–∫-–≤–æ:*

–†–∞–±–æ—Ç–∞ `join` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `get`. `get` —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ `rank(root)` $\leqslant O(\log n)$. 











## 22-11-23

### –ñ–∞–¥–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

#### –ê–ª–≥–æ—Ä–∏—Ç–º –•–∞—Ñ—Ñ–º–∞–Ω–∞

–ï—Å—Ç—å –∞–ª—Ñ–∞–≤–∏—Ç. –î–ª—è –∫–∞–∂–¥–æ–π –±—É–∫–≤—ã –∏–∑–≤–µ—Å—Ç–Ω—ã 

- $cnt_i$ -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π (–ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —Å –∫–æ—Ç–æ—Ä–æ–π –±—É–∫–≤–∞ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–µ)
- $a_i \in \{ 0, 1 \}^*$ -- –∫–æ–¥ –±—É–∫–≤—ã 
- $l_i = | a_i |$ -- –¥–ª–∏–Ω–∞ –∫–æ–¥–∞ –±—É–∫–≤—ã 

–•–æ—Ç–∏–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –∫–æ–¥—ã –±—É–∫–≤ —Ç–∞–∫, —á—Ç–æ–±—ã –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –±—ã–ª–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π.  

$\sum l_i \cdot cnt_i \rightarrow \min$ = –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞

$\sum l_i \cdot \underbrace{p_i}_{\in [0, 1]} \rightarrow \min$ = –ï[–¥–ª–∏–Ω—ã –æ–¥–Ω–æ–π –±—É–∫–≤—ã] 





**–ê–ª–≥–æ—Ä–∏—Ç–º:**

–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º $cnt_i$ –ø–æ —É–±—ã–≤–∞–Ω–∏—é, $l_i$ -- –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. –ü–æ–ª—É—á–∏–º –¥–µ—Ä–µ–≤–æ, –≥–¥–µ –ø—É—Ç—å –æ—Ç –∫–æ—Ä–Ω—è –¥–æ –ª–∏—Å—Ç–∞ -- –∫–æ–¥ –±—É–∫–≤—ã.

–ë—É–¥–µ–º —Å–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ –±—É–∫–≤—ã $a_{n-1}$ –∏ $a_n$ (—É –Ω–∏—Ö $cnt = \min$) –≤ –æ–¥–Ω—É –Ω–æ–≤—É—é –±—É–∫–≤—É $a_p$. $cnt_p = cnt_n + cnt_{n - 1}$.

–ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –æ—á–µ—Ä–µ–¥—å. 

```c++
new_letter = n;
vector<int> cnt(2 * n);
vector<pair<int, int>> children(2 * n);
set<pair<int, int>> q;
for (int i = 0; i < n; ++i)
    q.insert({cnt[i], i});
while (q.size() >= 2) {
    auto a = *q.begin();
    q.erase(q.begin());
    auto b = *q.begin();
    q.erase(q.begin());
    cnt[new_letter] = cnt[a.first] + cnt[b.first];
    q.insert({cnt[new_letter], new_letter});
    children[new_letter++] = {a.second, b.second};
}
```

–†–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(n \log n)$, —Ç–∞–∫ –∫–∞–∫ $n$ –∏—Ç–µ—Ä–∞—Ü–∏–π + —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ $q$. 





**–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞:**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º $a_n$ -- —Å–∞–º—ã–π –≥–ª—É–±–æ–∫–∏–π –ª–∏—Å—Ç. $l_n = \max(l_i)$. –£ –Ω–µ–≥–æ –µ—Å—Ç—å –±—Ä–∞—Ç (–∏–Ω–∞—á–µ —É–±–µ—Ä—ë–º –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –≤ –∫–æ–¥–µ –±—É–∫–≤—ã). –¢–æ –µ—Å—Ç—å $\exists k \ : \ l_k = l_n$. 

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º $a_{n-1}$.

$\left . \begin{array}{r} l_{n - 1} \geqslant l_k \\ l_{n-1} \leqslant l_n \\ l_n = l_k \end{array} \right \} \ \Rightarrow \ l_{n-1} = l_n.$ –ü–æ–º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ $a_k$ –∏ $a_{n-1}$ ( OPT –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è). 

–ó–∞–º–µ–Ω–∏–º $a_n$ –∏ $a_{n-1}$ –Ω–∞ –Ω–æ–≤—É—é –±—É–∫–≤—É $a_p$. $cnt_p = cnt_n + cnt_{n-1}$.







#### –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã 

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –∑–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π. –ù–∞–¥–æ –ø—Ä–∏–¥—É–º–∞—Ç—å —Ç–∞–∫–æ–π –∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä, —á—Ç–æ–±—ã *–ª—é–±—ã–µ –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –±—ã–ª–∏ —Å—Ä–∞–≤–Ω–∏–º—ã –º–µ–∂–¥—É —Å–æ–±–æ–π* –∏ *–≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç—å*. 

–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –Ω—É–∂–Ω–æ —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –∏—Ö —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å. 





##### –°–º–æ—Ç—Ä–∏–º –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç 

–ï—Å—Ç—å $n$  –∑–∞–¥–∞—á. –ó–∞–¥–∞—á–∞ $a_i$ —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞ –≤—Ä–µ–º—è $t_i$. –•–æ—Ç–∏–º —Ä–µ—à–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –∑–∞ –æ–±—â–µ–µ –≤—Ä–µ–º—è $T$ $\Leftrightarrow$ $\sum \limits _1 ^k a_i \leqslant T, \ k \rightarrow \max$.



–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º $t_i$ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. $t_{j_1} \leqslant t_{j_2} \leqslant ... \leqslant t_{j_n}$.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∑–∞–¥–∞—á—É $a_{j_1}$,  $t_{j_1} = \min t_i$. 

1) $a_{j_1} \in OPT$. –ï—Å–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å $a_{j_1}$ –Ω–∞ –∫–∞–∫—É—é-—Ç–æ –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É, –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ç–æ–ª—å–∫–æ –≤–æ–∑—Ä–∞—Å—Ç—ë—Ç.
2) $a_{j_1} \notin OPT$. –¢–æ–≥–¥–∞ $\exists k \ : \ a_k \in OPT \ \and \ t_k \geqslant t_{j_1}$. –ó–∞–º–µ–Ω–∏–º $a_k$ –Ω–∞ $a_{j_1}$,  –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ç–æ–ª—å–∫–æ —É–º–µ–Ω—å—à–∏—Ç—Å—è.

–ó–Ω–∞—á–∏—Ç, –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å $t_i$ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. 





##### –£–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ $OPT$

–ï—Å—Ç—å $n$ –∑–∞–¥–∞—á. –î–ª—è –∫–∞–∂–¥–æ–π –∏–∑–≤–µ—Å—Ç–Ω–æ –≤—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è $t_i$ –∏ –¥–µ–¥–ª–∞–π–Ω $d_i$. –ú–æ–∂–Ω–æ –ª–∏ —Ä–µ—à–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏? 



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–¥–∞—á—É. $\sum \limits_1^n t_i = \sum \limits_1^{n-1} t_i + t_i \leqslant d_n \ \Rightarrow \ d_n = \max d_i$. 

–ó–Ω–∞—á–∏—Ç, –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å –Ω—É–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ–¥–ª–∞–π–Ω—ã –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ $\forall k \ : \ \sum \limits_1^k t_k \leqslant d_k$. 





##### –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ –¥–≤–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–∞

–ï—Å—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ –ª–µ–Ω—Ç–µ. 

$size_i$ -- —Ä–∞–∑–º–µ—Ä $i$-–æ–≥–æ —Ñ–∞–π–ª–∞. 

$pos_i$ -- –Ω–∞—á–∞–ª–æ $i$-–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ –ª–µ–Ω—Ç–µ. 

$cnt_i$ -- –∫–æ–ª-–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ $i$-–æ–º—É —Ñ–∞–π–ª—É. 

$\sum \limits_1^n cnt_i \cdot pos_i \rightarrow \min$



$OPT$ -- –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –°–≤–∞–ø–Ω–µ–º $i$-—ã–π –∏ $(i+1)$-—ã–π —Ñ–∞–π–ª—ã –∏ –ø–æ–ª—É—á–∏–º —Ä–µ—à–µ–Ω–∏–µ $OPT_1 \geqslant OPT$.

 $OPT = \sum \limits_1^n cnt_k \cdot pos_k$

$OPT_1 = \sum \limits_{\begin{array}{c} k \neq i \\ k \neq i + 1 \end{array}} cnt_k \cdot pos_k + pos_i \cdot cnt_{i + 1} + (pos_i + size_{i + 1}) \cdot cnt_i$

$OPT_1 \geqslant OPT \ \Rightarrow \ \frac{size_i}{cnt_i} \leqslant \frac{size_{i+1}}{cnt_{i+1}}$

–ó–Ω–∞—á–∏—Ç, —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é $\frac{size_i}{cnt_i}$. 











## 22-11-30

### –ü—Ä–∞–≤–∏–ª–æ –í–∞–Ω—Å–¥–æ—Ä—Ñ–∞ 

–®–∞—Ö–º–∞—Ç–Ω–∞—è –¥–æ—Å–∫–∞ $8 \times 8$. –•–æ—Ç–∏–º –∫–æ–Ω—ë–º –æ–±–æ–π—Ç–∏ –≤—Å–µ –∫–ª–µ—Ç–∫–∏.

$\deg v$ -- –æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –≤–µ—Ä—à–∏–Ω–∫–∏  -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω–æ–∫, –≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ö–æ–¥. 

–ü—Ä–∞–≤–∏–ª–æ –í–∞–Ω—Å–¥–æ—Ä—Ñ–∞ –≥–æ–≤–æ—Ä–∏—Ç, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–µ—Ä—à–∏–Ω—ã:

- –≤—ã–±–∏—Ä–∞—Ç—å –≤–µ—Ä—à–∏–Ω—É —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Å—Ç–µ–ø–µ–Ω—å—é 
- –ø—Ä–∏ —Ä–∞–≤–Ω–æ–π –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –≤—ã–±–∏—Ä–∞—Ç—å –≤–µ—Ä—à–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –±–ª–∏–∂–µ –∫ –∫—Ä–∞—é –¥–æ—Å–∫–∏ 



–û–±–æ–±—â–µ–Ω–∏—è –¥–ª—è –≥—Ä–∞—Ñ–æ–≤: 

1. –¥–æ—Å–∫–∞ $n \times n$
2. –¥–∞–Ω –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ
   - –∏–¥–µ–º –≤ min –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é —Å—Ç–µ–ø–µ–Ω—å
   - –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Å—Ç–µ–ø–µ–Ω–µ–π –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∏–∑ –≤–µ—Ä—à–∏–Ω–æ–∫. –£ –≤–µ—Ä—à–∏–Ω–∫–∏ $v$ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–∞–≤–Ω–∞ $\frac{1}{\deg v}$. 



–†–µ—à–µ–Ω–∏–µ: 

–í–∞—Ä–∏–∞–Ω—Ç 1 -- –ø–µ—Ä–µ–±–æ—Ä. –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –ø–æ—Ç–æ–º –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º—Å—è –Ω–∞–∑–∞–¥. 

–í–∞—Ä–∏–∞–Ω—Ç 2 -- —Å–ª—É—á–∞–π–Ω–æ–µ –±–ª—É–∂–¥–∞–Ω–∏–µ. –ö–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –≤–µ—Ä—à–∏–Ω–∫—É. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –¥–æ–π–¥–µ–º –¥–æ —Ñ–∏–Ω–∏—à–∞, —Ç–æ–≥–¥–∞ –Ω–∞—á–Ω–µ–º —Å–Ω–∞—á–∞–ª–∞. 
